<!DOCTYPE html>
{% extends "base.html" %}
{% load staticfiles %}
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>{% block title %}ACCUEIL : Voici la liste de vos communautés préférées !{% endblock title %}</title>
</head>
<hr>
<div>{% block h1 %} Bienvenue {{ request.user.get_username }}, sur la page des communautés ! {% endblock h1 %}</div>

{% block h3 %}
{%if communautes%}
{% for communaute in communautes %}
<div class="communaute table-hover slideIn">
    <h1><b>{{ communaute.name|capfirst }}
        {% if request.user == communaute.createur %}
        <a href="{% url 'update_communaute' communaute.id %}">
            <i class="far fa-edit"></i>
        </a>
        {% endif %}</b></h1>

    <p><i class="fas fa-users"></i>
        {% for u in communaute.abonnes.all %}
        {{ u.get_username }}-
        {% endfor %}</p>
    {% if request.user in communaute.abonnes.all %}
    <a span href="{% url 'abonnements' communaute.id %}"><i class="fas fa-heart pull-right"></i></a>
    <p><a href="{% url 'communaute' communaute.id %}">Lire les Posts</a></p>
    {% else %}
        {%if not request.user in communaute.list_bannis.all%}
    <a span href="{% url 'abonnements' communaute.id %}"><i class="far fa-heart pull-right"></i> </a>
        {%else%}
    Vous avez été banni.e de cette Communauté.
        {% endif %}
    {% endif %}
    {# Section pour fermer/détruire une communauté si le créateur est l'utilisateur#}
    {% if communaute.createur == request.user or request.user.is_superuser %}
        {% if communaute.ferme %}
        <a span href="{% url 'fermer' communaute.id %}"><i class="fas fa-lock"></i></a>
        {%else%}
        <a span href="{% url 'fermer' communaute.id %}"><i class="fas fa-lock-open"></i></a>
        {%endif%}
        {% if request.user.is_superuser%}
        {% if communaute.ferme_invisible %}
        <a span href="{% url 'fermer_invisible' communaute.id %}"><i class="fas fa-lock" style="color:indianred"></i></a>
        {%else%}
        <a span href="{% url 'fermer_invisible' communaute.id %}"><i class="fas fa-lock-open" style="color:indianred"></i></a>
        {%endif%}
        {%endif%}
        <a span href="{% url 'detruire' communaute.id %}"><i class="fas fa-trash-alt pull-right"></i></a>
    {% endif %}

</div>
<hr class="my-4"/>

{% endfor %}

{% else%}
Créer la première communauté ?
<a href="{% url 'nouvelle_communaute'  %}"><i class="far fa-edit"></i></a>
{% endif%}
{% endblock h3 %}

</body>
</html>
